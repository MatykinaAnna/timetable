"use strict";(self.webpackChunktimetable=self.webpackChunktimetable||[]).push([[756],{9756:(z,g,a)=>{a.r(g),a.d(g,{OrganizerModule:()=>U});var l=a(9808),f=a(2214),t=a(1223),p=a(2963),_=a(3545);let h=(()=>{class n{constructor(e){this.dateService=e}ngOnInit(){console.log("ngOnInit user")}go(e){this.dateService.changeMonth(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-selector"]],decls:9,vars:5,consts:[[1,"material-icons",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"p")(1,"i",0),t.NdJ("click",function(){return o.go(-1)}),t._uU(2,"arrow_left"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"moment"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"i",0),t.NdJ("click",function(){return o.go(1)}),t._uU(8,"arrow_right"),t.qZA()()),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,t.lcZ(6,3,o.dateService.date))," "))},pipes:[_.d,l.Ov],styles:["p[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 2rem;text-align:center;width:200px}p[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}"]}),n})();var d=a(5439);function v(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",2),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).select(r.value)}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"moment"),t.qZA()()}if(2&n){const e=i.$implicit;t.ekj("disabled",e.disabled)("active",e.active)("selected",e.selected),t.xp6(2),t.hij(" ",t.xi3(3,7,e.value,"DD")," ")}}function C(n,i){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,v,4,10,"td",1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("ngForOf",e.days)}}a(6866),d.locale("ru");let T=(()=>{class n{constructor(e){this.dateService=e,this.calendar=null}ngOnInit(){this.dateService.date.subscribe(this.generate.bind(this))}generate(e){const o=e.clone().startOf("month").startOf("week"),s=e.clone().endOf("month").endOf("week"),r=o.clone().subtract(1,"day"),m=[];for(;r.isBefore(s,"day");)m.push({days:Array(7).fill(0).map(()=>{const u=r.add(1,"day").clone();return{value:u,active:d().isSame(u,"date"),disabled:!e.isSame(u,"month"),selected:e.isSame(u,"date")}})});this.calendar=m}select(e){this.dateService.changeDate(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-calendar"]],decls:19,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"disabled","active","selected","click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"table")(1,"thead")(2,"tr")(3,"th"),t._uU(4,"\u041f\u043d"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"\u0412\u0442"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"\u0421\u0440"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"\u0427\u0442"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"\u041f\u0442"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"\u0421\u0431"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"\u0412\u0441"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,C,2,1,"tr",0),t.qZA()()),2&e&&(t.xp6(18),t.Q6J("ngForOf",o.calendar))},directives:[l.sg],pipes:[_.d],styles:["table[_ngcontent-%COMP%]{width:100%;margin-bottom:2px;border-collapse:collapse}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #000;padding:2px}td[_ngcontent-%COMP%]{text-align:center;transition:all .2s}td.disabled[_ngcontent-%COMP%]{opacity:.5}td[_ngcontent-%COMP%]:hover:not(.disabled){background:#eee;cursor:pointer}.active[_ngcontent-%COMP%]{background-color:#76e7e7;font-weight:700}.selected[_ngcontent-%COMP%]{background-color:#a3a3a3}"]}),n})();var x=a(3900),k=a(7501),Z=a(6138),b=a(7556),c=a(2382);function y(n,i){if(1&n&&(t.TgZ(0,"label",9),t._uU(1),t.qZA()),2&n){const e=t.oxw(3).index,o=t.oxw();t.MGl("for","time-",e,""),t.xp6(1),t.hij(" ",o.time[e].format("HH:mm")," ")}}function O(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.YNc(1,y,2,2,"label",7),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"button",8),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).index,r=t.oxw();return r.remove(r.time[s].format("HH:mm"))}),t._uU(5," \u0445 "),t.qZA()()}if(2&n){const e=t.oxw(2).index,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.time[e]),t.xp6(2),t.hij(" ",o.taskIsSet(o.time[e].format("HH:mm")).title," ")}}function M(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,O,6,2,"div",6),t.qZA()),2&n){const e=t.oxw().index,o=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==o.taskIsSet(o.time[e].format("HH:mm")).task?null:o.taskIsSet(o.time[e].format("HH:mm")).task.author_id)==o.user_id)}}function S(n,i){if(1&n&&(t.TgZ(0,"label",9),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).index,o=t.oxw();t.MGl("for","time-",e,""),t.xp6(1),t.hij(" ",o.time[e].format("HH:mm")," ")}}function A(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,S,2,2,"label",7),t._UZ(2,"input",10),t.qZA()),2&n){const e=t.oxw().index,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.time[e]),t.xp6(1),t.MGl("id","time-",e,""),t.Q6J("formControlName",e)}}function F(n,i){if(1&n&&(t.TgZ(0,"div",5),t.YNc(1,M,2,1,"div",6),t.YNc(2,A,3,3,"div",6),t.qZA()),2&n){const e=i.index,o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.taskIsSet(o.time[e].format("HH:mm")).rez),t.xp6(1),t.Q6J("ngIf",!o.taskIsSet(o.time[e].format("HH:mm")).rez)}}let I=(()=>{class n{constructor(e,o,s,r,m){this.dateService=e,this.adminService=o,this.taskService=s,this.authService=r,this.fb=m,this.setting=null,this.time=[],this.array_tasks=[],this.profileForm=this.fb.group({tasks:this.fb.array([])})}ngOnInit(){console.log("ngOnInit"),this.adminService.getSetting().subscribe(e=>{this.setting=e;let o=d().set("hour",e.start).set("minute",0).set("second",0),s=d().set("hour",e.end).set("minute",0).set("second",0),r=o.clone();for(;r<=s;)this.time.push(r.clone()),this.addInputTask(),r.add(e.min,"m")}),this.getTasks()}get user_id(){return this.authService.getToken()}get tasks(){return this.profileForm.get("tasks")}getTasks(){this.dateService.date.pipe((0,x.w)(e=>this.taskService.load(e))).subscribe(e=>{this.array_tasks=e})}addInputTask(){this.tasks.push(this.fb.control(""))}save(){for(let e in this.tasks.value)if(this.tasks.value[e]){let o={title:this.tasks.value[e],date:this.dateService.date.value.format("DD-MM-YYYY"),time:this.time[Number(e)].format("HH:mm"),author_id:String(this.authService.getToken)};this.taskService.addTask(o).subscribe(s=>{this.array_tasks.push(s),this.profileForm.reset()},s=>console.error(s))}}taskIsSet(e){let o=this.array_tasks.findIndex(s=>s.time==e);return o>-1?{rez:!0,title:this.array_tasks[o].title,task:this.array_tasks[o]}:{rez:!1}}remove(e){let o=this.taskIsSet(e).task;o&&this.taskService.remove(o).subscribe(()=>{this.getTasks()},s=>console.error(s))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.R),t.Y36(k.l),t.Y36(Z.M),t.Y36(b.e),t.Y36(c.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-timetable"]],decls:6,vars:2,consts:[[1,"container"],["action","",3,"formGroup"],["formArrayName","tasks"],["class","task",4,"ngFor","ngForOf"],[3,"click"],[1,"task"],[4,"ngIf"],[3,"for",4,"ngIf"],[1,"btn","btn-primery","btn-del",3,"click"],[3,"for"],["type","text",3,"id","formControlName"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"div",2),t.YNc(3,F,3,2,"div",3),t.TgZ(4,"button",4),t.NdJ("click",function(){return o.save()}),t._uU(5,"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),t.qZA()()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",o.profileForm),t.xp6(2),t.Q6J("ngForOf",o.tasks.controls))},directives:[c._Y,c.JL,c.sg,c.CE,l.sg,l.O5,c.Fj,c.JJ,c.u],styles:[".container[_ngcontent-%COMP%]{margin-top:10px}.task[_ngcontent-%COMP%]{display:flex}.task[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:5px}"]}),n})();const H=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-main-component"]],decls:4,vars:0,consts:[[1,"container"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-selector")(2,"app-calendar")(3,"app-timetable"),t.qZA())},directives:[h,T,I],styles:[""]}),n})(),children:[]}];let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.Bz.forChild(H)],f.Bz]}),n})();var Y=a(544);let U=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[l.ez,J,c.u5,c.UX,Y.T]]}),n})()}}]);